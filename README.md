# Домашнее задание к занятию «Резервное копирование баз данных» - Михалёв Сергей

### Задание 1. Резервное копирование

### Кейс
Финансовая компания решила увеличить надёжность работы баз данных и их резервного копирования. 

Необходимо описать, какие варианты резервного копирования подходят в случаях: 

1.1. Необходимо восстанавливать данные в полном объёме за предыдущий день.

1.2. Необходимо восстанавливать данные за час до предполагаемой поломки.

1.3.* Возможен ли кейс, когда при поломке базы происходило моментальное переключение на работающую или починенную базу данных.

*Приведите ответ в свободной форме.*

**Решение**

В задании ничего не сказано об объёме данных.

1.1. Здесь подойдёт последний полный бэкап и последний дифференциальный бэкап, который охватывает все изменения с момента последнего полного бэкапа.

1.2. В виду скорости, компактности и возможности большего точей восстановления, здесь подойдёт инкрементный бэкап.

1.3. Кейс master-slave.

---

### Задание 2. PostgreSQL

2.1. С помощью официальной документации приведите пример команды резервирования данных и восстановления БД (pgdump/pgrestore).

2.1.* Возможно ли автоматизировать этот процесс? Если да, то как?

*Приведите ответ в свободной форме.*

**Решение**

2.1. В презентации  к занятию сеть [ссылка](https://www.postgresql.org/docs/9.6/backup-dump.html) на официальную документацию SQL Dump PostgreSQL.

Сохранение дампа: ```pg_dump dbname > dumpfile```

[Если копнуть поглубже](https://www.postgresql.org/docs/7.1/app-pgdump.html), то можно рассмотреть варианты сохренения данных в различных форматах.

Восстановление: ```dbname < dumpfile```

Так же есть [описание](https://www.postgresql.org/docs/7.4/app-pgrestore.html) опций и синопсиса для команды ```pg_restore ```, что даёт больше возможностей для работы с файлами дампа.

* Процесс резервирования можно и нужно автоматизирова, например при помощи сткриптов в связке с ```crontab```.

---

### Задание 3. MySQL

3.1. С помощью официальной документации приведите пример команды инкрементного резервного копирования базы данных MySQL. 

*Приведите ответ в свободной форме.*

**Решение**

Инкрементное копирование можно поизводить командой ```sqlbackup``` с [опцией](https://dev.mysql.com/doc/mysql-enterprise-backup/8.0/en/backup-incremental-options.html) ```--incremental```. Интересный вариант использования ```history:{last_backup | last_full_backup} ```

Пример команды: ```mysqldump ncremental-base=history:last_full_backup.```

---

